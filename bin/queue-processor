#!/usr/bin/env node
'use strict';

let amqp = require('amqp');
let config = require('../config').get('/queues');

const connection = amqp.createConnection({
    url: config.rabbit.url
});

connection.on('ready', function () {
    const queue = connection.queue('tag.updates', {
        durable: true,
        autoDelete: false
    }, function() {
        console.log('Queue processor started');

        queue.subscribe(function(msg, headers, deliveryInfo, messageObject) {
            console.log(msg);
        });
    });
});
